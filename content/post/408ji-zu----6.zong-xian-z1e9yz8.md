---
title: 408计组——6.总线
slug: 408ji-zu----6.zong-xian-z1e9yz8
url: /post/408ji-zu----6.zong-xian-z1e9yz8.html
date: '2024-09-18 21:25:48+08:00'
lastmod: '2024-09-21 10:47:03+08:00'
toc: true
tags:
  - '408'
  - 计算机组成原理
categories:
  - 提桶跑路笔记
keywords: 408,计算机组成原理
isCJKLanguage: true
---





## 总线概述

### 总线基本概念

1. **总线定义**

    ⼀组能为多个部件分时、共享的公共信息传送路线

    **分时：** 同⼀时刻只允许有⼀个部件向总线发送信息；同⼀时刻只能有⼀个主设备控制总线的传输操作

    **共享**：总线上可以挂接多个部件
2. **总线设备**

    按对总线有无控制作用分为主设备、从设备

    * **主设备：** 发出总线请求获得总线控制权的设备
    * **从设备：** 被主设备访问的设备，只能响应总线命令
3. **总线特性**

    * 机械特性：尺⼨，⼤⼩
    * 电⽓特性：传输⽅向和有效电平范围
    * 功能特性：每根传输线的功能
    * 时间特性：信号和时序的关系

### 总线分类

* **按功能层次分类**

  1. **片内总线**

      芯片内部总线，如上章CPU介绍部分
  2. 系统总线

      各功能部件（CPU、主存、I/O接⼝）之间相互连接的总线

      * **数据总线**

        传输各功能部件之间的数据信息

        双向传输线，位数<u>与机器字⻓、存储字⻓有关</u>
      * **地址总线**

        指出主存和I/O设备接⼝电路的地址

        单向传输线，位数<u>与主存地址空间的⼤⼩有关</u>
      * **控制总线**

        传输控制信息

        包括控制命令和反馈信号
  3. **I/O总线**

      主要连接中低速I/O设备，使低速、高速设备分离

      通过I/O接口与系统总线相连
  4. **通信总线**

      计算机系统与其他系统传送信息的总线，也称为<u>外部总线</u>
* **按时序控制方式分类**

  1. **同步总线**

      总线上设备按规定的时钟节拍统一工作
  2. **异步总线**

      以信号握手方式协调信息传输，总线操作时序不固定
* **按数据传输方式分类**

  1. **串行总线**

      数据的传输在⼀条线路上按位进⾏，适合长距离
  2. **并行总线**

      每个数据位有⼀条单独的传输线，所有的数据位同时进⾏，如地址线

      相互有干扰和延迟，适合近距离

### 系统总线的结构

||单总线结构|双总线结构|三总线结构|
| ------| ----------------------------------------------------------------------------------------------------| ---------------------------------------------------------------------------------------| ---------------------------------------------------------------------------------------|
|优点|• 结构简单，成本低<br />• 易于接⼊新的设备<br />|• 低速I/O设备分离<br />• 实现存储器总线和I/O总线分离|• 提⾼I/O设备性能<br />• 更快响应命令<br />• 提⾼系统吞吐量|
|缺点|• 带宽低，负载重<br />• 多个部件只能争⽤唯⼀的主线<br />• 不⽀持并发传送操作|• 需要增加通道等硬件设备|• 同时一条总线工作|
|组成|系统总线|主存总线<br />I/O总线<br />|I/O总线<br />主存总线<br />DMA总线<br />|
|结构|​![image](https://image-host-pkj.oss-cn-guangzhou.aliyuncs.com/image-20240919111825-f64lgag.png)​|​![image](https://image-host-pkj.oss-cn-guangzhou.aliyuncs.com/202409191119395.png)​|​![image](https://image-host-pkj.oss-cn-guangzhou.aliyuncs.com/202409191120288.png)​|

### 总线性能指标

1. **总线传输周期**

    指⼀次<u>总线操作所需的时间</u>，由若⼲总线<u>时钟周期构成</u>
2. **总线时钟周期**

    即<u>机器的时钟周期</u>
3. **总线工作频率**

    总线上各种操作的频率，为<u>总线周期的倒数</u>  

    <u>工作频率=1/总线周期</u>
4. **总线宽度（总线位宽）**

    总线上同时能传输的数据位数，通常指<u>数据总线的根数</u>
5. **总线带宽**

    总线的最⼤数据传输率，即<u>单位时间内总线上最多可传输数据的位数</u>  

    总线带宽=总线⼯作频率×(总线位宽/8)【单位 <u>字节/s</u>】
6. **总线复用**

    ⼀种信号线在不同的时间传输不同的信息

    因此可以使⽤较少的线传输更多的信息，从⽽节约空间和成本
7. **信号线数**

    地址总线、数据总线和控制总线<u>3种总线数的总和</u>称为信号线数

其中最重要的是**总线宽度、总线⼯作频率、总线带宽**

三者关系：（总线带宽）或者说（传输率）=总线宽度×总线⼯作频率

## 总线事务和定时

### 总线事务

**总线事务**：从请求总线到完成总线使⽤的操作序列【在⼀个总线周期中发⽣的⼀系列活动】

1. **请求阶段**

    主设备发出总线传输请求并且获得总线控制权
2. **仲裁阶段**

    总线仲裁机构决定将下⼀个传输周期的总线使⽤权授予某个申请者
3. **寻址阶段**

    主设备通过总线给出要访问的从设备地址及有关命令，启动从模块
4. **传输阶段**

    主模块和从模块进⾏数据交换，可单向或双向进⾏数据传送（⼀般只能传输⼀个字⻓的数据）
5. **释放阶段**

    主模块的有关信息均从系统总线上撤除，让出总线使⽤权

---

* **非突发方式**

  每个传送周期内先传地址，再传数据，且每次通常只能传输一个字节
* **突发（猝发）方式**

  发送⽅在传输完成地址后，连续进⾏若⼲次数据的发送，即⼀次**传输⼀个地址和⼀批连续的数据**

  寻址阶段发送<u>连续数据单元的⾸地址</u>，之后从⾸地址开始连续读出或写⼊多个数据，每个时钟周期传送一个字长

  一组数据传送完毕后释放总线

### 总线定时

**总线定时**：总线在双⽅交换数据的过程中需要时间上配合关系的控制【实质是⼀种协议或者规则】

||**同步定时方式**|**异步定时方式**|
| --| ------------------------------------------------------------------------------------------------------------------------| ------------------------------------------------------------------------------------------------------------------------------------------------|
|**定义**|• 同步通信采⽤<u>公共时钟</u>，有统⼀的时钟周期，同步时钟信号不由各设备提供<br />• 同步控制既可以⽤于<u>CPU控制</u>，⼜可⽤于⾼速的<u>外部设备控制</u>|• 不采⽤时钟信号，**采⽤握⼿** <br />• 完全依靠“握⼿”信号来实现定时控制<br />• 传送操作是由双⽅按需求分配时间的<br />• 每次握⼿完成⼀次通信，⼀次通信交换多位数据|
|**优点**|• 传送速度快<br />• 总线控制逻辑简单<br />• 不需要应答信息<br />• 总线⻓度短<br />• 公共时钟信号同步<br />• 各部件的存取时间较接近<br />|• 总线周期⻓度可变<br />• 保证两个速差很⼤部件/设备之间可靠信息交换<br />• ⾃适应时间配合<br />|
|**缺点**|• 主从设备强制性同步<br />• 不能验证数据通信的有效性<br />• 可靠性较差|• ⽐同步复杂，速度慢于同步⽅式|
|**适用**|• <u>总线⻓度较短及部件的存储时间⽐较接近</u><br />• 采⽤同步控制也可以进⾏数据的传输，但不能发挥快速设备的⾼速性能|• 主要⽤于在<u>不同的设备间</u>进⾏通信|

#### 异步定时方式分类

​![image](https://image-host-pkj.oss-cn-guangzhou.aliyuncs.com/202409191316797.png)​

1. **不互锁方式**

    主设备发请求---->**不必**等从设备的回答，撤销“请求信号” **【速度最快】**
2. **半互锁方式**

    主设备发请求--->**需要**等从设备的回答，才能撤销“请求信号”

    从设备收到回答--->**不必**等到主设备的"请求信号"撤销，才撤销“回答信号”
3. **全互锁方式**

    主设备发请求--->**需要**等从设备的回答，才能撤销“请求信号”

    从设备收到回答--->**需要**等到主设备的"请求信号"撤销，才撤销“回答信号”

#### 半同步定时方式

半同步定时方式保留了同步定时的特点

如所有地址、命令、数据信号的发出时间都严格**参照系统时钟**的某个前沿开始，而接收方都采用系统时钟后沿时刻来进行判断识别

同时，又像异步定时那样，允许不同速度的设备和谐地工作

因此，增设一条**Wait响应信号线**

> 例如，某个半同步总线总是从某个时钟开始，在每个时钟到来时，采样Wait信号，若无效，则说明数据未准备好，下个时钟到来时，再采样Wait信号，直到检测到有效，再去数据线上取数据。

半同步定时适用于系统工作速度不高，但又包含了由许多速度差异较大的各类设备组成的简单系统，即非关键模块允许根据特定时序自由运作，减少对主时钟的依赖

优点：控制方式比异步定时简单，各模块在系统时钟的控制下同步工作，可靠性较高。

缺点：系统时钟频率不能要求太高，所以从整体上来看，系统工作的速度不是很高。

#### 分离式定时方式

分离式定时方式将总线事务分解为<u>请求和应答</u>两个子过程

两个设备一个请求一个应答，轮流作为主设备占用总线传送信息

上述两个子过程都只有单方向的信息流

优点：在不传送数据时释放总线，使总线可接受其他设备的请求，不存在空闲等待时间。

缺点：控制复杂，开销也大。
